<h1>倉庫イベント（将軍ルート）</h1>

<section id="warehouse-general-script">

  <p class="prologue-line is-princess" data-line-id="princess_1">
    「ここに秘密兵器を隠しておいたの。これよ。」
  </p>

  <p class="prologue-line is-narrator" data-line-id="narrator_1">
    薄暗い倉庫の片隅で、古びた木箱の中に淡く光るカードが一枚だけ収められていた。<br>
    属性に縛られない特別な力を宿した――『無属性カード』だった。
  </p>

  <p class="prologue-line is-fairy" data-line-id="fairy_1">
    「これはすごいね……。<br>
     こんなに強い力を、ここまで隠しておくなんてさすが魔姫だよ。」
  </p>

  <p class="prologue-line is-princess" data-line-id="princess_2">
    「これで魔王と戦えるはずよ。<br>
     わたしはみんなが心配だから、向こうと合流するわ。――頑張ってね！」
  </p>

</section>

<hr>

<p>物語を先へ進めましょう。</p>
<ul>
  <li><%= link_to "魔王城へ進む", demonlord_intro_story_path, class: "btn" %></li>
</ul>

<div style="margin-top: 16px;">
  <button id="warehouse-general-play" class="btn" style="display:none;">
    ▶ 音声が再生されないときはこちらをクリック
  </button>
</div>

<audio id="warehouse-general-audio"></audio>

<script>
  document.addEventListener("turbo:load", function () {
    // このシーン用のコンテナが無ければ何もしない（他ページへの影響防止）
    const container = document.getElementById("warehouse-general-script");
    if (!container) return;

    // 共通セットアップ関数が無ければ諦める
    if (!window.setupVoicePlayer) {
      console.error("setupVoicePlayer が見つかりません（warehouse_general）");
      return;
    }

    // 共通ボイスプレイヤーを起動
    window.setupVoicePlayer({
      // ★ VoicesController の「倉庫イベント・将軍ルート」の順番と合わせる
      order: ["princess_1", "narrator_1", "fairy_1", "princess_2"],
      containerSelector: "#warehouse-general-script",
      lineSelector: ".prologue-line",
      playButtonSelector: "#warehouse-general-play",
      basePath: "/voices/warehouse_general"
    });
  });
</script>