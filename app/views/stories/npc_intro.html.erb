<h1>NPCとの会話</h1>

<p><strong>案内役:</strong> <%= @npc_message %></p>

<hr>

<div class="talk-log" style="border:1px solid #ccc; padding:8px; max-height:300px; overflow-y:auto;">
  <% @talk_logs.each do |log| %>
    <% if log["role"] == "user" %>
      <p style="margin-left:16px;">
        <strong>あなた:</strong> <%= log["content"] %>
      </p>
    <% elsif log["role"] == "assistant" %>
      <p>
        <strong>案内役:</strong> <%= log["content"] %>
      </p>
    <% end %>
  <% end %>
</div>

<hr>

<%= form_with url: npc_talk_story_path, method: :post, local: true do |f| %>
  <div>
    <%= f.label :player_message, "話しかける内容" %><br>
    <%= f.text_area :player_message, rows: 3 %>
  </div>

  <div style="margin-top:8px;">
    <%= f.submit "話す", class: "btn" %>
  </div>

  <div style="margin-top:8px;">
    <%= f.submit "この会話でキャラを確定する",
          class: "btn",
          name: "finish",
          value: "1" %>
  </div>
<% end %>

<%# <%= render "shared/voice_preloader" %>