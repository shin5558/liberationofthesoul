<h1>倉庫イベント（門番ルート）</h1>

<section id="warehouse-gate-script">

  <p class="prologue-line is-fairy"
     data-line-id="fairy_1">
    「ここは倉庫みたいだね。あっ！」
  </p>

  <p class="prologue-line is-fairy"
     data-line-id="fairy_2">
    「見て、こんなのがあったよ！」
  </p>

  <p class="prologue-line is-narrator"
     data-line-id="narrator_1">
      木箱の中から取り出されたのは、淡く光る一枚のカードだった。<br>
      属性の色を持たないそのカードは――『無属性カード』と呼ばれる特別な秘宝だ。
  </p>

  <p class="prologue-line is-fairy"
     data-line-id="fairy_3">
    「これで魔王と戦おう！<br>
     きっと、最後の一手を支えてくれるはずだよ。」
  </p>

</section>

<hr>

<p>物語を先へ進めましょう。</p>
<ul>
  <li>
    <%= link_to "魔王城へ進む", demonlord_intro_story_path, class: "btn" %>
  </li>
</ul>

<div style="margin-top: 16px;">
  <button id="warehouse-gate-play" class="btn" style="display:none;">
    ▶ 音声が再生されないときはこちらをクリック
  </button>
</div>

<audio id="warehouse-gate-audio"></audio>

<script>
  document.addEventListener("turbo:load", function () {
    // このシーン用のコンテナが無ければ何もしない（他ページへの影響防止）
    const container = document.getElementById("warehouse-gate-script");
    if (!container) return;

    // 共通セットアップ関数が無ければ諦める
    if (!window.setupVoicePlayer) {
      console.error("setupVoicePlayer が見つかりません（warehouse_gate）");
      return;
    }

    // 共通ボイスプレイヤーを起動
    window.setupVoicePlayer({
      // ★ VoicesController の 倉庫イベント（門番ルート） と同じ順番
      order: ["fairy_1", "fairy_2", "narrator_1", "fairy_3"],
      containerSelector: "#warehouse-gate-script",
      lineSelector: ".prologue-line",
      playButtonSelector: "#warehouse-gate-play",
      basePath: "/voices/warehouse_gate"
    });
  });
</script>